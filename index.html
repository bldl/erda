<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Erda</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewselflink" data-pltdoc="x">Erda</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="index.html#%28part._.Erda.R.V.M%29" class="tocviewlink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span></a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="index.html#%28part._.Erda.R.V.M_%29" class="tocviewlink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span></a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="index.html#%28part._.Erda.C__%29" class="tocviewlink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C+<span class="mywbr"> &nbsp;</span>+</span></span></a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="index.html#%28part._.Example_.Code%29" class="tocviewlink" data-pltdoc="x">Example Code</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="index.html#%28part._.Source_.Code%29" class="tocviewlink" data-pltdoc="x">Source Code</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="index.html#%28part._install%29" class="tocviewlink" data-pltdoc="x">Installation</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="index.html#%28part._.License%29" class="tocviewlink" data-pltdoc="x">License</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Erda%29" class="tocsubseclink" data-pltdoc="x">Erda</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Erda.R.V.M%29" class="tocsubseclink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span></a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Modules_and_.Macros%29" class="tocsubseclink" data-pltdoc="x">Modules and Macros</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Defining_.Forms%29" class="tocsubseclink" data-pltdoc="x">Defining Forms</a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">declare</span></span></a></td></tr><tr><td><span class="tocsublinknumber">1.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Alerts%29" class="tocsubseclink" data-pltdoc="x">Alerts</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.Expressions%29" class="tocsubseclink" data-pltdoc="x">Expressions</a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._~23~25datum%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">#%datum</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._quote%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">quote</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._value%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">value</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">if</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if-not%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">if-<wbr></wbr>not</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._or%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">or</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._and%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">and</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._cond%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">cond</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._anti-do%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">anti-<wbr></wbr>do</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">try</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._default%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">default</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">on-<wbr></wbr>alert</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">block</span></span></a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#%28part._.Standard_.Library%29" class="tocsubseclink" data-pltdoc="x">Standard Library</a></td></tr><tr><td><a href="#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._result~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">result?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">good-<wbr></wbr>result?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._bad-result~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bad-<wbr></wbr>result?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">raise</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Erda.R.V.M_%29" class="tocsubseclink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._if%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">if</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">when</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._unless%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">unless</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Erda.C__%29" class="tocsubseclink" data-pltdoc="x">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C+<span class="mywbr"> &nbsp;</span>+</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">declare</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.C___.Translation_.Advising_.Annotations%29" class="tocsubseclink" data-pltdoc="x">C+<span class="mywbr"> &nbsp;</span>+<span class="mywbr"> &nbsp;</span> Translation Advising Annotations</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Example_.Code%29" class="tocsubseclink" data-pltdoc="x">Example Code</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Source_.Code%29" class="tocsubseclink" data-pltdoc="x">Source Code</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._install%29" class="tocsubseclink" data-pltdoc="x">Installation</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.License%29" class="tocsubseclink" data-pltdoc="x">License</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">6.2.1</span></div><h2><a name="(part._.Erda)"></a>Erda</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tero Hasu</p></span></div><p>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>, Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span>, and Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> constitute a family of small programming languages and implementations for experimenting with error handling mechanisms. We use the unqualified name <a name="(tech._erda)"></a><span style="font-style: italic">Erda</span> to refer to the language family as a whole, or any one member of the family where the languages are all alike in relevant respects.</p><p>The &ldquo;concrete&rdquo; syntax of Erda resembles that of Racket (and Scheme).</p><h3>1<tt>&nbsp;</tt><a name="(part._.Erda.R.V.M)"></a><a name="(mod-path._erda/rvm)"></a>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span></h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="index.html#%28mod-path._erda%2Frvm%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/rvm</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">erda</span></span></td></tr></table></p><p>The <a name="(tech._erdarvm)"></a><span style="font-style: italic">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span></span> language is a dynamically typed language that includes an <span style="font-style: italic">alerts</span> mechanism for declarative error reporting, and transparently propagates errors as data values.</p><p>This document describes the syntax and semantics of a selection of the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>-specific constructs.</p><p>The <a href="index.html#%28mod-path._erda%2Frvm%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/rvm</span></a> language also inherits a number of constructs directly from Racket, including the <span class="RktSym"><a href="http://docs.racket-lang.org/reference/begin.html#%28form._%28%28quote._~23~25kernel%29._begin%29%29" class="RktStxLink" data-pltdoc="x">begin</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/begin.html#%28form._%28%28quote._~23~25kernel%29._begin0%29%29" class="RktStxLink" data-pltdoc="x">begin0</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%2A%29%29" class="RktStxLink" data-pltdoc="x">let*</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._letrec%29%29" class="RktStxLink" data-pltdoc="x">letrec</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span>, and <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> syntactic forms, and the <span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span> function. These forms should therefore behave as described in the Racket documentation. Note, however, that functions may seemingly behave differently due to Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s different function application semantics.</p><h4>1.1<tt>&nbsp;</tt><a name="(part._.Modules_and_.Macros)"></a>Modules and Macros</h4><p>The Racket <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> and <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> forms (and associated sub-forms) may be used in Erda as normal to import modules and to define the interfaces exposed by modules.</p><p>Macros are not included in the language by default, but there is nothing preventing from <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span>&rsquo;ing macro support from Racket.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Defining_.Forms)"></a>Defining Forms</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._define))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:handler</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:direct</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Forms used to define variables and functions.</div></p><p>The semantics of the <span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktVar">id</span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">)</span> form is the same as in Racket. In Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> functions are not first class, and the language does not include a <span class="RktSym">lambda</span> form, and thus this form is intended only for defining variables (that do not name functions).</p><p>The second form, which is for defining &ldquo;regular&rdquo; Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> functions, binds <span class="RktVar">id</span> as a function that takes arguments <span class="RktVar">arg</span><span class="stt"> </span><span class="RktMeta">...</span>. The language enforces that the arguments will all have to be good, wrapped values (i.e., values for which the predicate <span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValLink" data-pltdoc="x">good-result?</a></span> holds); there is an implicit alert guarding against bad values. Explicit alerts may be specified according to the <span class="RktVar">maybe-alerts</span> grammar. The result of the function should be a single wrapped value (i.e., values for which <span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._result~3f%29%29" class="RktValLink" data-pltdoc="x">result?</a></span> holds). Indeed, Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> does not support multi-value returns, or more generally, multi-value expressions. The language enforces, on the single return value, the data invariant associated with its type; the function application will produce a bad value instead if the invariant does not hold. Explicit post-conditions are treated similarly. The invariants are not checked on bad results.</p><p>The <span class="RktPn">#:handler</span> variant of the <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> form is like the &ldquo;regular&rdquo; function definition form, but without the implicit alerts requiring good arguments, or the assumption that post-condition expressions require good free variables. That is, any pre-conditions get evaluated even if some of the arguments are bad, and if they hold, the function gets called. Similarly, any post-conditions (but not data invariant) are also checked on a bad result. The intention is for this kind of function definition to make it possible to implement &ldquo;handler&rdquo; functions able to process (and perhaps recover from) bad values.</p><p>The <span class="RktPn">#:direct</span> variant of the form defines a function that is called directly, without the language doing any pre- or post-processing on the incoming or outgoing values, which are still expected to be wrapped (no data invariants is checked either, so beware). This form of <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> is intended to allow for the implementation of Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> functions (such that they are aware of wrapped values) as Racket-based primitives, probably using Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/application.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._~23~25plain-app%29%29" class="RktStxLink" data-pltdoc="x">#%plain-app</a></span> form as the &ldquo;FFI&rdquo; for implementing such primitives within the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> language. Perhaps more likely, you&rsquo;ll want to implement such functions in Racket, and instead merely <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> them as <span class="RktPn">#:direct</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._declare))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">declare</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">declare</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:direct</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Forms used to specify information about functions, not to implement them, or to bind the identifier <span class="RktVar">id</span>. The binding must already exist.</div></p><p>The first <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> form declares a Racket primitive that processes unwrapped values, and thus will get automatic unwrapping/wrapping at the application site. Alert clauses may be specified, with any <span class="RktSym">test-expr</span> evaluated with the <span class="RktVar">arg</span> (and <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._value%29%29" class="RktStxLink" data-pltdoc="x">value</a></span>, as appropriate) identifiers bound to <span style="font-style: italic">wrapped</span> values; in other words, despite a primitive function being called, the conditional expressions are still written in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>. As many existing Racket functions may throw exceptions, it is quite important to specify <span class="RktSym">on-throw</span> alert clauses as appropriate, as a way of converting from such a foreign error reporting mechanism.</p><p>The second <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> form is like the <span class="RktPn">#:direct</span> <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> form, but without taking an implementation. An implementation must already be bound as the function <span class="RktVar">id</span>.</p><p>It is also possible to call un<span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span>d Racket functions, as long as they are bound. Naturally, then, no explicit alerts have been specified, but goodness of arguments is nonetheless enforced, and arguments are unwrapped automatically; undeclared functions are expected to process unwrapped values. There is no catching of exceptions, but the data invariant of the result value is checked. A broken DI leads to the result being automatically wrapped as a bad value, whereas otherwise it is wrapped as a good value.</p><h5>1.2.1<tt>&nbsp;</tt><a name="(part._.Alerts)"></a>Alerts</h5><p>The alert specification of a <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>d or <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span>d function matches the following grammar.</p><p><table cellspacing="0" cellpadding="0"><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">maybe-alerts</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:alert</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">alert-clause</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">alert-clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">alert-id</span><span class="hspace">&nbsp;</span><span class="RktSym">pre-when</span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">alert-id</span><span class="hspace">&nbsp;</span><span class="RktSym">pre-unless</span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">alert-id</span><span class="hspace">&nbsp;</span><span class="RktSym">post-when</span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">alert-id</span><span class="hspace">&nbsp;</span><span class="RktSym">post-unless</span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">alert-id</span><span class="hspace">&nbsp;</span><span class="RktSym">on-throw</span><span class="hspace">&nbsp;</span><span class="RktVar">pred-expr</span><span class="RktPn">)</span></td></tr></table></p><p>where:</p><blockquote class="leftindent"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><span class="RktVar">alert-id</span></td></tr></table></blockquote><p>An alert name. The name of the alert to trigger if the corresponding <span class="RktSym">test-expr</span> holds, or if the corresponding <span class="RktSym">pred-expr</span> predicate holds for a thrown exception object.</p></blockquote><blockquote class="leftindent"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><span class="RktVar">test-expr</span></td></tr></table></blockquote><p>An Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> expression, computing in wrapped values.
The <span class="RktVar">test-expr</span>s of <span class="RktPn">#:handler</span> functions should probably be able to deal with bad values as well.</p><p>The expression is automatically negated for the <span class="RktSym">pre-unless</span> and <span class="RktSym">post-unless</span> cases.</p><p>For post-condition expressions, the result of the function application is bound as <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._value%29%29" class="RktStxLink" data-pltdoc="x">value</a></span>.</p></blockquote><blockquote class="leftindent"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><span class="RktVar">pred-expr</span></td></tr></table></blockquote><p>A Racket predicate expression, computing in bare values. The predicate should accept any bare <span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._exn%29%29" class="RktValLink" data-pltdoc="x">exn</a></span> structure (or a subtype) as an argument, and yield a bare value indicating whether the predicate holds.</p></blockquote><h4>1.3<tt>&nbsp;</tt><a name="(part._.Expressions)"></a>Expressions</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._~23~25datum))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._~23~25datum%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">#%datum</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktVar">datum</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A good literal value, as specified by <span class="RktVar">datum</span>.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">0</span></td></tr><tr><td><p><span class="RktRes">(Good 0)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._quote))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._quote%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">quote</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A good symbol <span class="RktVal">&rsquo;</span><span class="RktVar">id</span>. In Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> symbols are primarily used to name alerts.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">'</span><span class="RktVal">not-found</span></td></tr><tr><td><p><span class="RktRes">(Good 'not-found)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><a name="(form._((lib._erda/i1-lang..rkt)._value))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._value%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">value</a></span></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A result value. Bound in the scope of a <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> or <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> post-condition expression, for example, but also in some other syntactic contexts that have expressions for result processing (see <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span>, for example).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._if))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">if</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">else-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>, but processes wrapped values. If <span class="RktVar">test-expr</span> yields a bad value, then the overall expression yields a bad value, and neither branch is evaluated. If <span class="RktVar">test-expr</span> yields a good <span class="RktVal">#f</span>, then the <span class="RktVar">else-expr</span> expression is evaluated. Otherwise <span class="RktVar">then-expr</span> is evaluated.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">yes</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">no</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Bad bad-arg monadic-if)&#8592;(Bad bad raise)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._if-not))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if-not%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">if-not</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">else-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="stt"> </span><span class="RktVar">test-expr</span><span class="stt"> </span><span class="RktVar">else-expr</span><span class="stt"> </span><span class="RktVar">then-expr</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._or))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._or%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">or</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span>, but processes wrapped values. If any of the <span class="RktVar">expr</span>essions yields a bad value, none of the remaining expressions are evaluated, and the overall result will also be bad.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._and))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._and%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">and</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span>, but processes wrapped values. If any of the <span class="RktVar">expr</span>essions yields a bad value, none of the remaining expressions are evaluated, and the overall result will also be bad.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._cond))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._cond%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">cond</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cond-clause</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="hspace">&nbsp;</span><span class="RktVar">else-clause</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">cond-clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">else-clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A conditional expression that processes wrapped values. If any of the <span class="RktVar">test-expr</span>essions yields a bad value, none of the remaining expressions are evaluated, and the overall result will also be bad. Note the compulsory <span class="RktSym">else</span> clause, which is a significant difference compared to Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">false</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">otherwise</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(Bad bad-arg monadic-if)&#8592;(Bad bad raise)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._anti-do))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._anti-do%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">anti-do</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Locally switches to a bare-value &ldquo;evaluation mode,&rdquo; for the <span class="RktVar">body</span> expressions. Each argument value, given by <span class="RktVar">expr</span>, is unwrapped and bound to the corresponding <span class="RktVar">arg</span>, which must be an identifier. Said identifiers will be bound in the scope of the body. The result of the body expressions is then again wrapped, in either a good or bad wrapper, based on the DI. The overall expression fails if any <span class="RktVar">expr</span> yields a bad value, and in that case the body is left unevaluated.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._try))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">try</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="hspace">&nbsp;</span><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktVar">catch-clause</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-catch-all</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">catch-clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-catch-all</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates the <span class="RktVar">body</span> expressions, and if the last of them yields a bad result, then matches it against the <span class="RktVar">catch-clause</span>s based on the alert name of the bad value. The optional <span class="RktVar">maybe-catch-all</span> clause will match anything. If the body result is good, or if there is no matching clause, then that result remains the result of the overall expression. Otherwise the result is given by the last <span class="RktVar">then-expr</span> of the first matching clause.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">worst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">bad</span><span class="hspace">&nbsp;</span><span class="RktSym">worse</span><span class="hspace">&nbsp;</span><span class="RktSym">still-worse</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">worst</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(Good 2)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">worse</span><span class="hspace">&nbsp;</span><span class="RktSym">worst</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Bad bad raise)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 1)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:catch</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">_</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 3)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._default))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._default%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">default</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">try-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">fail-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates the <span class="RktVar">try-expr</span> expression, and only if its result is a bad one, then evaluates the <span class="RktVar">fail-expr</span> for the result of the overall expression. Where the result of <span class="RktVar">try-expr</span> is good, that becomes the value of the overall expression.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._default%29%29" class="RktStxLink" data-pltdoc="x">default</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">good</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">alternative</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 'good)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._default%29%29" class="RktStxLink" data-pltdoc="x">default</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">alternative</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 'alternative)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._on-alert))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">on-alert</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">handler-clause</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">handler-clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Installs handlers for the scope of the <span class="RktVar">body</span> expressions, the last of which normally gives the result of the overall expression.</div></p><p>If any application of a function listed by <span class="RktVar">id</span> fails (with a bad result), then a matching clause&rsquo;s <span class="RktVar">expr</span>essions are evaluated, and the result of the last of them is substituted in place of the result of the failed function call.</p><p>This recovery mechanism does not apply to syntactic forms (even if named by <span class="RktVar">id</span>), nor will recovery happen within the body of an <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._anti-do%29%29" class="RktStxLink" data-pltdoc="x">anti-do</a></span> expression.</p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="RktStxLink" data-pltdoc="x">on-alert</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">nothing</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 'nothing)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="RktStxLink" data-pltdoc="x">on-alert</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">good</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Bad bad raise)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="RktStxLink" data-pltdoc="x">on-alert</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">good</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 'good)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/i1-lang..rkt)._block))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">block</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">stat</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="hspace">&nbsp;</span><span class="RktVar">result-expr</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">stat</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">expr</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates a sequence of restricted &ldquo;statements,&rdquo; in the order given. Each <span class="RktVar">stat</span> may be an assignment, a conditional assignment, or an expression. Conditional assignment only happens if the condition is a good true value. What appears to be assignment to a previously defined variable is actually a shadowing single static assignment. Any <span class="RktVar">id</span> that gets bound is in scope for the rest of the expression. A restriction of conditional assignment is that conditional assignment to an unbound <span class="RktVar">id</span> is not allowed, as then <span class="RktVar">id</span> might not be bound for the rest of the expression.</div></p><p>The evaluation of the overall expression immediately stops with a bad value if a <span class="RktVar">test-expr</span> produces a bad value.  Where there were no failures in conditionals, the overall result of the expression will be that of <span class="RktVar">result-expr</span>.</p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 3)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 1)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 2)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 2)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good 1)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._block%29%29" class="RktStxLink" data-pltdoc="x">block</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">bad</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">#:let</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">good</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Bad bad-arg monadic-if)&#8592;(Bad bad raise)</span></p></td></tr></table></blockquote></div></p><h4>1.4<tt>&nbsp;</tt><a name="(part._.Standard_.Library)"></a>Standard Library</h4><p>This section lists a small selection of the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> standard library.</p><p>The documented argument and result types (or predicates, rather) are only for informational purposes; they are not necessarily enforced using actual contracts (indeed the language does not have support for contracts built-in).</p><p>Some functions do have pre- and post-conditions specified with alert clauses, but these are not indicated in the signatures shown here; the signatures here reflect the functions&rsquo; own ability to handle inputs. It is the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> language itself that does further enforcing, according to explicit or implicit alert conditions.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._erda/i1-lib..rkt)._result~3f))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._result~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">result?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValLink" data-pltdoc="x">good-result?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A predicate that holds if <span class="RktVar">x</span> is a wrapped value (whether good or bad). The result of the predicate is itself wrapped.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._erda/i1-lib..rkt)._good-result~3f))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">good-result?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValLink" data-pltdoc="x">good-result?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A predicate that holds if <span class="RktVar">x</span> is a good (wrapped) value.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._erda/i1-lib..rkt)._bad-result~3f))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._bad-result~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">bad-result?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValLink" data-pltdoc="x">good-result?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A predicate that holds if <span class="RktVar">x</span> is a bad (wrapped) value.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._bad-result~3f%29%29" class="RktValLink" data-pltdoc="x">bad-result?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">worst</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Good #t)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._erda/i1-lib..rkt)._raise))"></a><span title="Provided from: erda/rvm | Package: erda"><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValDef RktValLink" data-pltdoc="x">raise</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">alert-name</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._bad-result~3f%29%29" class="RktValLink" data-pltdoc="x">bad-result?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">alert-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._good-result~3f%29%29" class="RktValLink" data-pltdoc="x">good-result?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new bad value with the specified <span class="RktVar">alert-name</span>, passed in as a wrapped symbol. The constructed bad value will have no history beyond the call to this function.</div></p><h3>2<tt>&nbsp;</tt><a name="(part._.Erda.R.V.M_)"></a><a name="(mod-path._erda/sigma-rvm)"></a>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span></h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="index.html#%28mod-path._erda%2Fsigma-rvm%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/sigma-rvm</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">erda</span></span></td></tr></table></p><p>The <a name="(tech._erdarvm~cf~83)"></a><span style="font-style: italic">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span></span> language is a variant of Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> such that it exports an assignment expression, and modified conditionals with optional cleanup actions. Only the additions are documented here.</p><p>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span>&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span> form (for variable assignment) is the same as in Racket. Bad values also get assigned.</p><p>The only conditionals available in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span> are <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>, <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span>, and <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._unless%29%29" class="RktStxLink" data-pltdoc="x">unless</a></span>. The other conditionals from Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> are not available. More or less all other forms (e.g., <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>) and functions (e.g., <span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span>) from Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> <span style="font-style: italic">are</span> also included in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span><span style="vertical-align: super; font-size: 80%">&#963;</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/sigma-rvm..rkt)._if))"></a><span title="Provided from: erda/sigma-rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._if%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">if</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">then-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">else-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-cleanup</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-cleanup</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:cleanup</span><span class="hspace">&nbsp;</span><span class="RktVar">cleanup-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>, but may include cleanup actions. Said actions are given as a sequence of <span class="RktVar">cleanup-expr</span> expressions, which are evaluated for their side effects in the case that <span class="RktVar">test-expr</span> yields a bad value; this does not influence the result of the overall expression, which will still be as for Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">failed?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">worse</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">#:cleanup</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">failed?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(Bad bad-arg monadic-if/cleanup)&#8592;(Bad worse raise)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">failed?</span></td></tr><tr><td><p><span class="RktRes">(Good #t)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/sigma-rvm..rkt)._when))"></a><span title="Provided from: erda/sigma-rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">when</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-cleanup</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span>, but processes wrapped values, and may include cleanup actions. Where <span class="RktVar">test-expr</span> is a good <span class="RktVal">#f</span> value, the result of the overall expression will be <a href="http://docs.racket-lang.org/guide/void_undefined.html" class="RktModLink" data-pltdoc="x"><span class="nobreak"><span class="RktRes">#&lt;void&gt;</span></span></a>, without any wrapper.</div></p><p>Note that there is no <span class="RktSym">when</span> or <span class="RktSym">unless</span> in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>, as having them makes little sense without side effects (such as assignment).</p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(Good 3)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/sigma-rvm..rkt)._unless))"></a><span title="Provided from: erda/sigma-rvm | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._unless%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">unless</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">test-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-cleanup</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span>, but evaluates <span class="RktVar">body</span> expressions in the case where <span class="RktVar">test-expr</span> is a good <span class="RktVal">#f</span> value.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._unless%29%29" class="RktStxLink" data-pltdoc="x">unless</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fsigma-rvm..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._erda%2Fi1-lib..rkt%29._raise%29%29" class="RktValLink" data-pltdoc="x">raise</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">worst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:cleanup</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(Good 3)</span></p></td></tr></table></blockquote></div></p><h3>3<tt>&nbsp;</tt><a name="(part._.Erda.C__)"></a><a name="(mod-path._erda/cxx)"></a>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span></h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="index.html#%28mod-path._erda%2Fcxx%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/cxx</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">erda</span></span></td></tr></table></p><p>The <a name="(tech._erdac++)"></a><span style="font-style: italic">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span></span> language is a statically typed language such that it includes an alerts mechanism for declarative error reporting, and transparently propagates errors as data values.</p><p><div class="SIntrapara">Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> is very similar to Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>, but with some notable differences:
</div><div class="SIntrapara"><ul><li><p>Provided that any referenced functions are implemented both for Racket and C++, the definitions appearing in a <a href="index.html#%28mod-path._erda%2Fcxx%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/cxx</span></a> module (or collection thereof) may both be used directly from a Racket program, and translated into a C++ API and implementation usable from C++ programs. In contrast, the definitions appearing in a <a href="index.html#%28mod-path._erda%2Frvm%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/rvm</span></a> module are only intended for evaluation in the Racket VM.</p></li><li><p>While the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> and Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> implementations are largely based on the same code, the former does somewhat more work at compile time. This is to keep the runtime requirements smaller, and thus facilitate translation into C++. The only C++ runtime requirements for the <a href="index.html#%28mod-path._erda%2Fcxx%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">erda/cxx</span></a> language itself are a small subset of the C and C++11 standard libraries, and the <span class="stt">"erda.hpp"</span> header file.</p></li><li><p>Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>&rsquo;s functions and variables are typed, whereas in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> it is values that are typed. While the static types need not always be declared, the types of a program must be fully resolvable statically. For this purpose, the compiler features Hindley-Milner style type inference.</p></li><li><p>For declaring types and other details relating to translating Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> into C++, the language features support for various annotations (e.g., <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._type%29%29" class="RktStxLink" data-pltdoc="x">type</a></span>, <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._foreign%29%29" class="RktStxLink" data-pltdoc="x">foreign</a></span>, etc.) that may be specified for declarations; there are no such annotations in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>.</p></li><li><p>Not everything from Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> has been brought over to Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>; notably, some of the error recovery supporting forms are missing, as is most of the runtime library. The focus in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> has been to include only the essentials in the language, and exclude more experimental features (such as <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._try%29%29" class="RktStxLink" data-pltdoc="x">try</a></span> and <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._on-alert%29%29" class="RktStxLink" data-pltdoc="x">on-alert</a></span>). The idea is to improve and validate the design of these features in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> first, before bringing them into other Erda variants.</p></li></ul></div></p><p>This document describes the syntax and semantics a selection of those Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> constructs that have notable differences to Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s. Overall, Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>&rsquo;s syntactic constructs generally have the same semantics as in Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>, and we do not document them separately here.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/cxx..rkt)._define))"></a><span title="Provided from: erda/cxx | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">#:type</span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:handler</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:direct</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Forms used to define types, variables and functions.</div></p><p>These forms have the same semantics as for Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>, with three notable exceptions. Firstly, there is a <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> <span class="RktPn">#:type</span> form, which is the same as for Magnolisp&rsquo;s <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>. Second, Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> does not support the <span class="RktSym">on-throw</span> alert clause; the <span class="RktVar">maybe-alerts</span> grammar is otherwise the same as given in the <a href="index.html#%28part._.Alerts%29" data-pltdoc="x">Alerts</a> section. Third, all the <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> variants accept optional annotations; the grammar for <span class="RktVar">maybe-annos</span> is as described in <a href="http://magnolisp.github.io/index.html#%28part._.Annotations%29" data-pltdoc="x">Annotations</a>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._erda/cxx..rkt)._declare))"></a><span title="Provided from: erda/cxx | Package: erda"><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">declare</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">#:type</span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">declare</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-alerts</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">declare</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:direct</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-annos</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Forms used to specify information about types and functions, not to implement them, or to bind the identifier <span class="RktVar">id</span>. The binding must already exist.</div></p><p>See <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> for a description of the three notable differences between Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>&rsquo;s <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> compared to Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span>&rsquo;s <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fi1-lang..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span> and Magnolisp&rsquo;s <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span>, as these differences are the same for both <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> and <span class="RktSym"><a href="index.html#%28form._%28%28lib._erda%2Fcxx..rkt%29._declare%29%29" class="RktStxLink" data-pltdoc="x">declare</a></span>.</p><h4>3.1<tt>&nbsp;</tt><a name="(part._.C___.Translation_.Advising_.Annotations)"></a>C++ Translation Advising Annotations</h4><p>Some of the Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> defining forms support a subset of the <a href="http://magnolisp.github.io/index.html#%28part._.Annotations%29" data-pltdoc="x">annotations</a> that appear in the Magnolisp language. The supported annotations are:
<span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._type%29%29" class="RktStxLink" data-pltdoc="x">type</a></span>, <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span>, <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._foreign%29%29" class="RktStxLink" data-pltdoc="x">foreign</a></span>, and <span class="RktSym"><a href="http://magnolisp.github.io/index.html#%28form._%28%28lib._magnolisp%2Fsurface..rkt%29._literal%29%29" class="RktStxLink" data-pltdoc="x">literal</a></span>. The purpose of these annotations is to instruct Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>-to-C++ translation. Refer to Magnolisp documentation for more details about them.</p><h3>4<tt>&nbsp;</tt><a name="(part._.Example_.Code)"></a>Example Code</h3><p>For sample Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">RVM</span></span> code, see the <span class="stt">"i1-prog.rkt"</span> file of the Erda implementation codebase. Said code should evaluate as is within the Racket VM; see the <span class="stt">racket</span> command of your Racket installation.</p><p>For sample Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> programs, see the <span class="stt">"test-*.rkt"</span> files and <span class="stt">"program-*"</span> projects in the <span class="stt">"tests"</span> directory of the codebase.</p><p>Most of the provided sample Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span> programs will evaluate as is within the Racket VM. To instead translate said programs into C++, see the Magnolisp documentation, or look at the <span class="stt">"Makefile"</span>s in the <span class="stt">"program-*"</span> directories for example invocations of the <span class="stt">mglc</span> command-line tool.</p><p><div class="SIntrapara">To run basic tests to verify that the Magnolisp compiler is available and working, you may run:
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">make test</span></div></p><h3>5<tt>&nbsp;</tt><a name="(part._.Source_.Code)"></a>Source Code</h3><p><div class="SIntrapara">A Git repository of the Erda source code can be found at:
</div><div class="SIntrapara"><blockquote><p><a href="https://github.com/bldl/erda"><span class="url">https://github.com/bldl/erda</span></a></p></blockquote></div></p><h3>6<tt>&nbsp;</tt><a name="(part._install)"></a>Installation</h3><p><div class="SIntrapara">The pre-requisites for installing the software are:
</div><div class="SIntrapara"><ul><li><p><span style="font-weight: bold">Racket.</span> The primary implementation language of Erda. Version 6 (or higher) of Racket is required; a known-compatible version is 6.2.1, but versions 6.1&ndash;6.2.1 are all expected to work.</p></li><li><p><span style="font-weight: bold">Magnolisp.</span> A language and compiler serving as a basis for the implementation of Erda<span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">C++</span></span>. A known-compatible revision of Magnolisp is d04ab2502745a261fcb94bd03a773fa64186be0c.</p></li></ul></div></p><p>The software and the documentation can be built from source, or installed using the Racket package manager.
Racket is required for building and installation.</p><p><div class="SIntrapara">Once Racket and its tools have been installed, the Magnolisp and Erda packages can be installed with the <span class="stt">raco</span> commands:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco pkg install git://github.com/bldl/magnolisp#d04ab25</span></p></td></tr><tr><td><p><span class="stt">raco pkg install git://github.com/bldl/erda</span></p></td></tr></table></blockquote></div></p><p>The above commands should install the library, the command-line tool(s), and a HTML version of the manual.</p><h3>7<tt>&nbsp;</tt><a name="(part._.License)"></a>License</h3><p>Except where otherwise noted, the following license applies:</p><p>Copyright &#169; 2014-2015 University of Bergen and the authors.</p><p>Authors: Tero Hasu</p><p>Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation files
(the "Software"), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software,
and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:</p><p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p><p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>